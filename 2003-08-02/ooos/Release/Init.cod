; Listing generated by Microsoft (R) Optimizing Compiler Version 13.00.9466 

	TITLE	Init.cpp
	.386P
include listing.inc
if @Version gt 510
.model FLAT
else
_TEXT	SEGMENT PARA USE32 PUBLIC 'CODE'
_TEXT	ENDS
_DATA	SEGMENT DWORD USE32 PUBLIC 'DATA'
_DATA	ENDS
CONST	SEGMENT DWORD USE32 PUBLIC 'CONST'
CONST	ENDS
_BSS	SEGMENT DWORD USE32 PUBLIC 'BSS'
_BSS	ENDS
$$SYMBOLS	SEGMENT BYTE USE32 'DEBSYM'
$$SYMBOLS	ENDS
$$TYPES	SEGMENT BYTE USE32 'DEBTYP'
$$TYPES	ENDS
_TLS	SEGMENT DWORD USE32 PUBLIC 'TLS'
_TLS	ENDS
;	COMDAT ??_C@_1DE@JBMIFNHF@?$AAC?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAS?$AAh?$AAe?$AAl?$AAl?$AA?5?$AAP?$AAr?$AAo?$AAc?$AAe@
CONST	SEGMENT DWORD USE32 PUBLIC 'CONST'
CONST	ENDS
;	COMDAT ??_C@_1M@GFEGCGOG@?$AAD?$AAo?$AAn?$AAe?$AA?6?$AA?$AA@
CONST	SEGMENT DWORD USE32 PUBLIC 'CONST'
CONST	ENDS
;	COMDAT ??0ProcessNode@@QAE@XZ
_TEXT	SEGMENT PARA USE32 PUBLIC 'CODE'
_TEXT	ENDS
;	COMDAT ??0Shell@@QAE@PAX0@Z
_TEXT	SEGMENT PARA USE32 PUBLIC 'CODE'
_TEXT	ENDS
;	COMDAT ??0Init@@QAE@PAX0@Z
_TEXT	SEGMENT PARA USE32 PUBLIC 'CODE'
_TEXT	ENDS
;	COMDAT ??1Init@@QAE@XZ
_TEXT	SEGMENT PARA USE32 PUBLIC 'CODE'
_TEXT	ENDS
;	COMDAT ?ProcessEntry@Init@@UAEXPAPAX@Z
_TEXT	SEGMENT PARA USE32 PUBLIC 'CODE'
_TEXT	ENDS
;	COMDAT ??_7Init@@6B@
CONST	SEGMENT DWORD USE32 PUBLIC 'CONST'
CONST	ENDS
;	COMDAT ??_7Shell@@6B@
CONST	SEGMENT DWORD USE32 PUBLIC 'CONST'
CONST	ENDS
FLAT	GROUP _DATA, CONST, _BSS
	ASSUME	CS: FLAT, DS: FLAT, SS: FLAT
endif

INCLUDELIB LIBC
INCLUDELIB OLDNAMES

PUBLIC	?ShellProcess@@3PAVProcess@@A			; ShellProcess
_BSS	SEGMENT
?ShellProcess@@3PAVProcess@@A DD 01H DUP (?)		; ShellProcess
_BSS	ENDS
PUBLIC	??0Shell@@QAE@PAX0@Z				; Shell::Shell
PUBLIC	??_7Shell@@6B@					; Shell::`vftable'
EXTRN	??0Process@@QAE@PAX0@Z:NEAR			; Process::Process
EXTRN	?ProcessEntry@Shell@@UAEXPAPAX@Z:NEAR		; Shell::ProcessEntry
;	COMDAT ??_7Shell@@6B@
; File d:\my documents\projects\ooos\current\ooos\shell.h
CONST	SEGMENT
??_7Shell@@6B@ DD FLAT:?ProcessEntry@Shell@@UAEXPAPAX@Z	; Shell::`vftable'
; Function compile flags: /Ogty
CONST	ENDS
;	COMDAT ??0Shell@@QAE@PAX0@Z
_TEXT	SEGMENT
_Start$ = 8
_End$ = 12
??0Shell@@QAE@PAX0@Z PROC NEAR				; Shell::Shell, COMDAT
; _this$ = ecx

; 7    : 	Shell(void * Start, void * End) : Process(Start, End) {};

  00000	8b 44 24 08	 mov	 eax, DWORD PTR _End$[esp-4]
  00004	56		 push	 esi
  00005	8b f1		 mov	 esi, ecx
  00007	8b 4c 24 08	 mov	 ecx, DWORD PTR _Start$[esp]
  0000b	50		 push	 eax
  0000c	51		 push	 ecx
  0000d	8b ce		 mov	 ecx, esi
  0000f	e8 00 00 00 00	 call	 ??0Process@@QAE@PAX0@Z	; Process::Process
  00014	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET FLAT:??_7Shell@@6B@
  0001a	8b c6		 mov	 eax, esi
  0001c	5e		 pop	 esi
  0001d	c2 08 00	 ret	 8
??0Shell@@QAE@PAX0@Z ENDP				; Shell::Shell
_TEXT	ENDS
PUBLIC	??0Init@@QAE@PAX0@Z				; Init::Init
PUBLIC	?ProcessEntry@Init@@UAEXPAPAX@Z			; Init::ProcessEntry
PUBLIC	??_7Init@@6B@					; Init::`vftable'
;	COMDAT ??_7Init@@6B@
; File d:\my documents\projects\ooos\current\ooos\init.cpp
CONST	SEGMENT
??_7Init@@6B@ DD FLAT:?ProcessEntry@Init@@UAEXPAPAX@Z	; Init::`vftable'
; Function compile flags: /Ogty
CONST	ENDS
;	COMDAT ??0Init@@QAE@PAX0@Z
_TEXT	SEGMENT
_Start$ = 8
_End$ = 12
??0Init@@QAE@PAX0@Z PROC NEAR				; Init::Init, COMDAT
; _this$ = ecx

; 10   : {

  00000	8b 44 24 08	 mov	 eax, DWORD PTR _End$[esp-4]
  00004	56		 push	 esi
  00005	8b f1		 mov	 esi, ecx
  00007	8b 4c 24 08	 mov	 ecx, DWORD PTR _Start$[esp]
  0000b	50		 push	 eax
  0000c	51		 push	 ecx
  0000d	8b ce		 mov	 ecx, esi
  0000f	e8 00 00 00 00	 call	 ??0Process@@QAE@PAX0@Z	; Process::Process
  00014	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET FLAT:??_7Init@@6B@

; 11   : }

  0001a	8b c6		 mov	 eax, esi
  0001c	5e		 pop	 esi
  0001d	c2 08 00	 ret	 8
??0Init@@QAE@PAX0@Z ENDP				; Init::Init
_TEXT	ENDS
PUBLIC	??1Init@@QAE@XZ					; Init::~Init
EXTRN	??1Process@@QAE@XZ:NEAR				; Process::~Process
; Function compile flags: /Ogty
;	COMDAT ??1Init@@QAE@XZ
_TEXT	SEGMENT
??1Init@@QAE@XZ PROC NEAR				; Init::~Init, COMDAT
; _this$ = ecx

; 14   : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET FLAT:??_7Init@@6B@

; 15   : }

  00006	e9 00 00 00 00	 jmp	 ??1Process@@QAE@XZ	; Process::~Process
??1Init@@QAE@XZ ENDP					; Init::~Init
_TEXT	ENDS
PUBLIC	??_C@_1DE@JBMIFNHF@?$AAC?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAS?$AAh?$AAe?$AAl?$AAl?$AA?5?$AAP?$AAr?$AAo?$AAc?$AAe@ ; `string'
PUBLIC	??_C@_1M@GFEGCGOG@?$AAD?$AAo?$AAn?$AAe?$AA?6?$AA?$AA@ ; `string'
EXTRN	??2@YAPAXI@Z:NEAR				; operator new
EXTRN	?CreateProcess@@YAHPAVProcess@@@Z:NEAR		; CreateProcess
EXTRN	?WriteString@VideoDriver@@QAEXPA_W@Z:NEAR	; VideoDriver::WriteString
EXTRN	?pDisp@@3PAVVideoDriver@@A:DWORD		; pDisp
;	COMDAT ??_C@_1DE@JBMIFNHF@?$AAC?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAS?$AAh?$AAe?$AAl?$AAl?$AA?5?$AAP?$AAr?$AAo?$AAc?$AAe@
; File d:\my documents\projects\ooos\current\ooos\shell.h
CONST	SEGMENT
??_C@_1DE@JBMIFNHF@?$AAC?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAS?$AAh?$AAe?$AAl?$AAl?$AA?5?$AAP?$AAr?$AAo?$AAc?$AAe@ DB 'C'
	DB	00H, 'r', 00H, 'e', 00H, 'a', 00H, 't', 00H, 'i', 00H, 'n', 00H
	DB	'g', 00H, ' ', 00H, 'S', 00H, 'h', 00H, 'e', 00H, 'l', 00H, 'l'
	DB	00H, ' ', 00H, 'P', 00H, 'r', 00H, 'o', 00H, 'c', 00H, 'e', 00H
	DB	's', 00H, 's', 00H, '.', 00H, '.', 00H, '.', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1M@GFEGCGOG@?$AAD?$AAo?$AAn?$AAe?$AA?6?$AA?$AA@
CONST	SEGMENT
??_C@_1M@GFEGCGOG@?$AAD?$AAo?$AAn?$AAe?$AA?6?$AA?$AA@ DB 'D', 00H, 'o', 00H
	DB	'n', 00H, 'e', 00H, 0aH, 00H, 00H, 00H	; `string'
; Function compile flags: /Ogty
; File d:\my documents\projects\ooos\current\ooos\init.cpp
CONST	ENDS
;	COMDAT ?ProcessEntry@Init@@UAEXPAPAX@Z
_TEXT	SEGMENT
_args$ = 8
?ProcessEntry@Init@@UAEXPAPAX@Z PROC NEAR		; Init::ProcessEntry, COMDAT
; _this$ = ecx

; 21   : 	// Create the shell process
; 22   : 	pDisp->WriteString(L"Creating Shell Process...");

  00000	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?pDisp@@3PAVVideoDriver@@A ; pDisp
  00006	56		 push	 esi
  00007	68 00 00 00 00	 push	 OFFSET FLAT:??_C@_1DE@JBMIFNHF@?$AAC?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAS?$AAh?$AAe?$AAl?$AAl?$AA?5?$AAP?$AAr?$AAo?$AAc?$AAe@
  0000c	e8 00 00 00 00	 call	 ?WriteString@VideoDriver@@QAEXPA_W@Z ; VideoDriver::WriteString

; 23   : 	ShellProcess = new Shell(reinterpret_cast<void *> (0xA13000), reinterpret_cast<void *> (0xA14000));

  00011	68 80 04 00 00	 push	 1152			; 00000480H
  00016	e8 00 00 00 00	 call	 ??2@YAPAXI@Z		; operator new
  0001b	8b f0		 mov	 esi, eax
  0001d	83 c4 04	 add	 esp, 4
  00020	85 f6		 test	 esi, esi
  00022	74 19		 je	 SHORT $L628
  00024	68 00 40 a1 00	 push	 10567680		; 00a14000H
  00029	68 00 30 a1 00	 push	 10563584		; 00a13000H
  0002e	8b ce		 mov	 ecx, esi
  00030	e8 00 00 00 00	 call	 ??0Process@@QAE@PAX0@Z	; Process::Process
  00035	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET FLAT:??_7Shell@@6B@
  0003b	eb 02		 jmp	 SHORT $L634
$L628:
  0003d	33 f6		 xor	 esi, esi
$L634:

; 24   : 	CreateProcess(ShellProcess);

  0003f	56		 push	 esi
  00040	89 35 00 00 00
	00		 mov	 DWORD PTR ?ShellProcess@@3PAVProcess@@A, esi ; ShellProcess
  00046	e8 00 00 00 00	 call	 ?CreateProcess@@YAHPAVProcess@@@Z ; CreateProcess
  0004b	83 c4 04	 add	 esp, 4
  0004e	5e		 pop	 esi

; 25   : 	pDisp->WriteString(L"Done\n");

  0004f	c7 44 24 04 00
	00 00 00	 mov	 DWORD PTR _args$[esp-4], OFFSET FLAT:??_C@_1M@GFEGCGOG@?$AAD?$AAo?$AAn?$AAe?$AA?6?$AA?$AA@
  00057	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?pDisp@@3PAVVideoDriver@@A ; pDisp
  0005d	e9 00 00 00 00	 jmp	 ?WriteString@VideoDriver@@QAEXPA_W@Z ; VideoDriver::WriteString
?ProcessEntry@Init@@UAEXPAPAX@Z ENDP			; Init::ProcessEntry
_TEXT	ENDS
END
